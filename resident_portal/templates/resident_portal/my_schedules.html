{% extends "resident_portal/base_resident.html" %}
{% load official_extras %}

{% block title %}My Schedules{% endblock %}

{% block content %}
<div class="bg-white p-6 md:p-8 rounded-lg shadow-md border">
    <!-- HEADER -->
    <div class="flex flex-col sm:flex-row items-start sm:items-center sm:justify-between mb-6 border-b pb-4">
        <div>
            <h1 class="text-3xl font-bold text-gray-900 flex items-center">
                <i class="bi bi-calendar2-week-fill text-green-600 mr-3"></i>
                My Hearing Schedules
            </h1>
            <p class="text-gray-500 mt-1">Your upcoming schedules for this week.</p>
        </div>
        <a href="{% url 'resident_portal:dashboard' %}" class="mt-4 sm:mt-0 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-lg inline-flex items-center text-sm">
            <i class="fas fa-arrow-left mr-2"></i>
            Back to Dashboard
        </a>
    </div>

    <!-- 5-DAY CALENDAR VIEW -->
    <div class="grid grid-cols-1 md:grid-cols-5 gap-px bg-gray-200 rounded-lg border overflow-hidden">
        {% for day in week_days %}
        <div class="bg-white">
            <!-- Day Header -->
            <div class="p-3 text-center bg-gray-50 border-b">
                <p class="text-sm font-semibold text-gray-700">{{ day|date:"l" }}</p>
                <p class="text-xs text-gray-500">{{ day|date:"M d" }}</p>
            </div>
            <!-- Schedules for the day -->
            <div class="p-3 space-y-3 min-h-[10rem]">
                {% for schedule in grouped_schedules|get:day %}
                <a href="{% url 'resident_portal:report_summary' schedule.case.pk %}" class="block p-3 rounded-lg transition-colors
                    {% if schedule.schedule_type == 'Summon' %} bg-blue-100 hover:bg-blue-200
                    {% elif schedule.schedule_type == 'Mediation' %} bg-green-100 hover:bg-green-200
                    {% else %} bg-purple-100 hover:bg-purple-200 {% endif %}">
                    <p class="font-bold text-sm text-gray-800">{{ schedule.appearance_time|time:"g:i A" }}</p>
                    <p class="text-xs text-gray-600 truncate">Case: {{ schedule.case.blotter_id }}</p>
                    <p class="text-xs font-semibold 
                        {% if schedule.schedule_type == 'Summon' %}text-blue-700
                        {% elif schedule.schedule_type == 'Mediation' %}text-green-700
                        {% else %}text-purple-700{% endif %}">
                        {{ schedule.schedule_type }}
                    </p>
                </a>
                {% empty %}
                <div class="flex items-center justify-center h-full pt-8">
                    <p class="text-xs text-gray-400">No schedules.</p>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}